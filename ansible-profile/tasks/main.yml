---
- name: "Install required Packages"
  ansible.builtin.import_tasks: packages.yml
  become: yes
  when: dotfile_install_packages
  tags:
    - install_packages

- name: "Move dotfiles in to place"
  ansible.builtin.import_tasks: dotfiles.yml
  when: dotfile_move_files
  tags:
    - move_files

- name: "Install HashiCorp software"
  ansible.builtin.include_tasks: 
    file: "{{ item }}"
  when: dotfile_install_hashicorp
  tags:
    - install_hashicorp
  with_first_found:
    - "hashicorp-{{ ansible_distribution }}.yml"
    - "hashicorp-{{ ansible_os_family }}.yml"
    - "hashicorp.yml"
    skip: True
